
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://sitename.example/">
      
      
      
        <link rel="next" href="rationale/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.13">
    
    
      
        <title>Model Composer and Visualizer</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#quick-start" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Model Composer and Visualizer" class="md-header__button md-logo" aria-label="Model Composer and Visualizer" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Model Composer and Visualizer
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Quick Start
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/liuji1031/model_composer" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    liuji1031/model_composer
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Model Composer and Visualizer" class="md-nav__button md-logo" aria-label="Model Composer and Visualizer" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Model Composer and Visualizer
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/liuji1031/model_composer" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    liuji1031/model_composer
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-yaml-format" class="md-nav__link">
    <span class="md-ellipsis">
      1. YAML format
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-define-modules" class="md-nav__link">
    <span class="md-ellipsis">
      2. Define modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Define modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-input-module" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Input module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-actual-modules" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Actual modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-output-module" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Output module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-real-world-example" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 Real-world example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-visualization-tool" class="md-nav__link">
    <span class="md-ellipsis">
      3. Visualization tool
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Visualization tool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-user-interface" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 User Interface
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Functionality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-composablemodel" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 ComposableModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-building-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      4. Building the model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Building the model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-registering-modules" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Registering modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-building-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Building the model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-summary" class="md-nav__link">
    <span class="md-ellipsis">
      5. Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="rationale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Why this could be useful
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-yaml-format" class="md-nav__link">
    <span class="md-ellipsis">
      1. YAML format
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-define-modules" class="md-nav__link">
    <span class="md-ellipsis">
      2. Define modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Define modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-input-module" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Input module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-actual-modules" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Actual modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-output-module" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Output module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-real-world-example" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 Real-world example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-visualization-tool" class="md-nav__link">
    <span class="md-ellipsis">
      3. Visualization tool
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Visualization tool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-user-interface" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 User Interface
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Functionality
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-composablemodel" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 ComposableModel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-building-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      4. Building the model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Building the model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-registering-modules" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Registering modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-building-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Building the model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-summary" class="md-nav__link">
    <span class="md-ellipsis">
      5. Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div><h1 id="quick-start">Quick Start</h1>
<p>This project aims to create a simple and intuitive format to:</p>
<ol>
<li>describe the architecture of a neural network</li>
<li>be easily parsed by a Python script to build the model</li>
<li>be parsed by a visualization tool to create a diagram of the architecture.</li>
</ol>
<p>To this end, a <strong><em>YAML</em></strong> format is defined to describe a so-called <strong><em>ComposableModel</em></strong> (<strong><em>CM</em></strong>), which can be uploaded to the <a href="https://network-visualizer-36300.web.app/"><strong><em>Neural Network Architecture Visualizer</em></strong></a> for visualization. The <strong><em>CM</em></strong> can be built using the <code>ComposableModel</code> class in the <code>model_composer</code> package (<a href="https://github.com/liuji1031/model_composer">repository</a>)</p>
<p>To use the visualization tool, you need to provide a valid YAML file (or a main YAML file with other referenced YAML files) that describes a <strong><em>CM</em></strong>. The YAML file should conform to the format described in the next section. A toy example is provided below, whose rendered architecture is also shown. </p>
<div class="admonition example">
<p class="admonition-title">Toy example</p>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">toy_example</span>
<span class="nt">modules</span><span class="p">:</span>
<span class="w">    </span><span class="nt">input</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x</span>

<span class="w">    </span><span class="nt">module_1</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">module_type_1</span>
<span class="w">      </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">param1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">42</span>
<span class="w">        </span><span class="nt">param2</span><span class="p">:</span><span class="w"> </span><span class="s">"42"</span>
<span class="w">      </span><span class="nt">out_num</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>

<span class="w">    </span><span class="nt">module_2</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">module_type_2</span>
<span class="w">      </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">module_1.0</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">module_2.yaml</span>

<span class="w">    </span><span class="nt">module_3</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">module_type_3</span>
<span class="w">      </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">module_2</span>

<span class="w">    </span><span class="nt">output</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">module_1.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">module_3</span>
</code></pre></div>
<figure>
<p><img alt="toy_example" src="assets/toy_example.svg" width="100%"></p>
<figcaption>
<p>Architecture of the toy example neural network. </p>
</figcaption>
</figure>
</div>
<h2 id="1-yaml-format">1. YAML format</h2>
<p>The YAML file for <strong><em>CM</em></strong> contains the following fields:</p>
<ul>
<li><strong><em>name</em></strong>: The name of the <strong><em>CM</em></strong>. This is used to identify the model in the visualization tool and in the code that builds the model. <br></li>
<li><strong><em>modules</em></strong>: A collection of modules that make up the model. Each module has a name, a set of parameters that define how to build it (except for the "input" and "output" module) and other fields that define the connections between the modules. The fields for each module include: <br><ul>
<li><strong><em>cls</em></strong>: The class of the module. This is used to identify the type of module in that builds the model. Optional for visualization.</li>
<li><strong><em>inp_src</em></strong>: A list of input sources for the module. These represent the positional arguments of the module.</li>
<li><strong><em>config</em></strong>: A dictionary of configuration parameters for the module. This can be either a dictionary of parameters or a path to a YAML file that contains the parameters. </li>
<li><strong><em>out_num</em></strong>: The number of outputs for the module. This is used to identify the output sources of the module. Default to 1 if not specified.</li>
</ul>
</li>
</ul>
<h2 id="2-define-modules">2. Define modules</h2>
<h3 id="21-input-module">2.1 Input module</h3>
<ul>
<li>The list of variable names under the <strong><em>input</em></strong> module defines the positional arguments of the model. </li>
<li>The names of the variables can be arbitrary, but they should be consistent with the rest of the YAML file.</li>
<li>
<p>The input module does not need any other fields, as its sole purpose is to define the positional arguments of the model.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>In the example above, the input module has a single positional argument called <strong><em>x</em></strong>, which is in turn passed to the first module, <strong><em>module_1</em></strong> (see its <strong><em>inp_src</em></strong> section). </p>
</div>
</li>
</ul>
<h3 id="22-actual-modules">2.2 Actual modules</h3>
<ul>
<li>The module <strong><em>name</em></strong> is the key of the module in the <strong><em>modules</em></strong> section. </li>
<li>
<p>The <strong><em>cls</em></strong> field is the class of the module needed to build the model. It can be built-in class (e.g., <code>torch.nn.Conv2D</code>) or custom registered class. This field can be omitted if only the visualization is needed.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>In the example above, the <strong><em>cls</em></strong> field is set to <strong><em>module_type_1</em></strong> for <strong><em>module_1</em></strong>, <strong><em>module_type_2</em></strong> for <strong><em>module_2</em></strong>, and <strong><em>module_type_3</em></strong> for <strong><em>module_3</em></strong>. The actual class names are important for building the model, but can be omitted for the visualization tool.</p>
</div>
</li>
<li>
<p>The <strong><em>inp_src</em></strong> field is a list of input sources for the module, representing its positional arguments. The input sources can come from any of the variables specified in the input module or from the outputs of other modules.</p>
<div class="admonition note">
<p class="admonition-title">How to specify module outputs</p>
<ol>
<li>when the module has only one output, the output can be specified by its name only, e.g., <strong><em>module_1</em></strong>.</li>
<li>when the module has more than one output, the output is specified by its name and the output index, e.g., <strong><em>module_1.0</em></strong>, where the index starts at 0 and goes up to <strong><em>out_num - 1</em></strong>, where <strong><em>out_num</em></strong> is the number of outputs for the module. The <strong><em>out_num</em></strong> field can be omitted if the module has only one output, otherwise it needs to be explicitly set in the YAML file. </li>
</ol>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>In the example above, <strong><em>module_1</em></strong> has two outputs, which are specified as <strong><em>module_1.0</em></strong> and <strong><em>module_1.1</em></strong>. In this case, the <strong><em>out_num</em></strong> field needs to be explicitly set to 2 (required) to indicate that the module has two outputs. All other modules have single outputs, so the outputs are specified by the module name only.</p>
</div>
</li>
<li>
<p>The <strong><em>config</em></strong> field can be either a dictionary of parameters or a path to a YAML file that contains the parameters that are needed to build the module.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>In the example above, <strong><em>module_1</em></strong> has two parameters, <strong><em>param1</em></strong> and <strong><em>param2</em></strong>. If a YAML file is provided as in <strong><em>module_2</em></strong>, the parameters are read from the file and passed to the module constructor. The <strong><em>config</em></strong> field can also be omitted if building the module with default parameters is desired or the file is used only for visualization.</p>
</div>
</li>
<li>
<p><strong><em>CM</em></strong> can be nested, meaning that one or more of its modules can be defined as other <strong><em>CM</em></strong>s, which allows the user to choose a specific hierarchical structure for best conveying the architecture of the model.</p>
<ul>
<li>The <strong><em>config</em></strong> for the nested <strong><em>CM</em></strong> is recommended to be a path to a separate YAML file that follows the same format as the main YAML file. </li>
<li>The visualization tool will automatically parse the nested <strong><em>CM</em></strong>. The user can double-click the nested <strong><em>CM</em></strong> to expand the module and inspect its internal structure. This is useful for visualizing complex architectures that can benefit from hierarchical representations. See <a href="#33-composablemodel"><strong>section 3.3</strong></a> for more details on how to interact with the <strong><em>CM</em></strong>s in the visualization tool.</li>
</ul>
</li>
</ul>
<h3 id="23-output-module">2.3 Output module</h3>
<ul>
<li>The output module is defined by a list of variable names that represent the outputs of the model.</li>
<li>The variable names can come from any of the modules defined in the <strong><em>modules</em></strong> section, including the input module.</li>
<li>
<p>The output module does not need any other fields, as its sole purpose is to define the outputs of the model.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>In the example above, the output module has two outputs, <strong><em>module_1.1</em></strong> (second output from <strong><em>module_1</em></strong>) and <strong><em>module_3</em></strong>. </p>
</div>
</li>
</ul>
<h3 id="24-real-world-example">2.4 Real-world example</h3>
<p>The example below shows how to define an real-world architecture, i.e., an inception block (3a) from the GoogLeNet, using the <strong><em>CM</em></strong> format. </p>
<p>The parsing relies on the <code>OmegaConf</code> library, which allows for easy interpolation of the parameters. Note the additional <strong><em>hyper_params</em></strong> section, which is helpful for defining all other inception blocks by swapping out the values. The user can thus define any number of additional fields in the YAML file as they see fit to expand the expressiveness of the YAML file. </p>
<div class="admonition example">
<p class="admonition-title">YAML file for the inception block</p>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_3a</span>
<span class="nt">hyper_params</span><span class="p">:</span>
<span class="w">  </span><span class="nt">in_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192</span>
<span class="w">  </span><span class="nt">n_filter_conv1x1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">64</span>
<span class="w">  </span><span class="nt">n_filter_3x3reduce</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">96</span>
<span class="w">  </span><span class="nt">n_filter_3x3</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">128</span>
<span class="w">  </span><span class="nt">n_filter_5x5reduce</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16</span>
<span class="w">  </span><span class="nt">n_filter_5x5</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">  </span><span class="nt">n_filter_pool_proj</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="nt">modules</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x</span>
<span class="w">  </span><span class="nt">conv1x1_3x3reduce</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Conv2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${hyper_params.in_channels}</span>
<span class="w">      </span><span class="nt">out_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${hyper_params.n_filter_3x3reduce}</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x</span>
<span class="w">  </span><span class="nt">conv1x1_5x5reduce</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Conv2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${hyper_params.in_channels}</span>
<span class="w">      </span><span class="nt">out_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${hyper_params.n_filter_5x5reduce}</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x</span>
<span class="w">  </span><span class="nt">maxpool</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.MaxPool2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x</span>
<span class="w">  </span><span class="nt">conv1x1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Conv2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${hyper_params.in_channels}</span>
<span class="w">      </span><span class="nt">out_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${hyper_params.n_filter_conv1x1}</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x</span>
<span class="w">  </span><span class="nt">conv3x3</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Conv2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${modules.conv1x1_3x3reduce.config.out_channels}</span>
<span class="w">      </span><span class="nt">out_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${hyper_params.n_filter_3x3}</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conv1x1_3x3reduce</span>
<span class="w">  </span><span class="nt">conv5x5</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Conv2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${modules.conv1x1_5x5reduce.config.out_channels}</span>
<span class="w">      </span><span class="nt">out_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${hyper_params.n_filter_5x5}</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conv1x1_5x5reduce</span>
<span class="w">  </span><span class="nt">conv1x1_pool_proj</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Conv2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${hyper_params.in_channels}</span>
<span class="w">      </span><span class="nt">out_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${hyper_params.n_filter_pool_proj}</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">maxpool</span>
<span class="w">  </span><span class="nt">concat</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DepthConcat</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conv1x1</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conv3x3</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conv5x5</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conv1x1_pool_proj</span>
<span class="w">  </span><span class="nt">output</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">concat</span>
</code></pre></div>
<figure>
<p><img alt="inception_3a" src="assets/inception_3a.svg" width="100%"></p>
<figcaption>
<p>Architecture of the Inception block from the GoogLeNet. </p>
</figcaption>
</figure>
</div>
<h2 id="3-visualization-tool">3. Visualization tool</h2>
<h3 id="31-user-interface">3.1 User Interface</h3>
<p><img alt="ui" src="assets/user_interface.png" width="100%">
The user interface of the visualization tool is designed to be intuitive and easy to use. The frontend is implemented using ReactFlow.</p>
<h3 id="32-functionality">3.2 Functionality</h3>
<ul>
<li><strong><em>Pre-uploaded Configurations</em></strong>: The user can select from a list of pre-uploaded neural network architectures to play with the visualization tool. The current list includes:<ul>
<li><em>GoogLeNet</em></li>
<li><em>PointNetConv</em></li>
<li><em>ToyExample</em> from the previous section</li>
</ul>
</li>
<li><strong><em>Upload YAML File</em></strong>: The user can upload a single YAML file that conforms to the format described above. The file is parsed and the architecture is rendered in the visualization tool. </li>
<li>
<p><strong><em>Upload Folder</em></strong>: The user can upload a folder that contains multiple YAML files. This useful when the main YAML file references other YAML files in the config field of one or more modules. The user will be asked to select the main YAML file, and the tool will automatically parse the other YAML files in the folder. The YAML files referenced need to be specified using relative paths.</p>
<div class="admonition example">
<p class="admonition-title">Example folder structure for GoogLeNet</p>
<p>One example folder structure is shown below, which is generated for GoogLeNet. Here <code>model.yaml</code> is the main YAML file, while the other YAML files referenced by the inception blocks and auxiliary classifiers are under <code>config</code> sub-directory. The main <code>model.yaml</code> file is also attached below. See all other YAML files <a href="https://github.com/liuji1031/model_composer/tree/master/example/yaml/GoogLeNet"><strong>here</strong></a>. <br></p>
<blockquote>
<p>GoogLeNet <br>
├── model.yaml <br>
└── config/<br>
        ├── inception_3a.yaml<br>
        ├── inception_3b.yaml<br>
        ├── inception_4a.yaml<br>
        ├── inception_4b.yaml<br>
        ├── inception_4c.yaml<br>
        ├── inception_4d.yaml<br>
        ├── inception_4e.yaml<br>
        ├── inception_5a.yaml<br>
        ├── inception_5b.yaml<br>
        ├── auxiliary_classifier_4a.yaml<br>
        └── auxiliary_classifier_4b.yaml<br></p>
</blockquote>
</div>
<details class="example">
<summary>model.yaml of GoogLeNet</summary>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GoogLeNet</span>
<span class="nt">modules</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x</span>
<span class="w">  </span><span class="nt">convolution_1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Conv2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">out_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">64</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x</span>
<span class="w">  </span><span class="nt">maxpool_1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.MaxPool2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">convolution_1</span>
<span class="w">  </span><span class="nt">convolution_2_reduce</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Conv2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">64</span>
<span class="w">      </span><span class="nt">out_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">64</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">maxpool_1</span>
<span class="w">  </span><span class="nt">convolution_2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Conv2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">64</span>
<span class="w">      </span><span class="nt">out_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">convolution_2_reduce</span>
<span class="w">  </span><span class="nt">maxpool_2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.MaxPool2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">convolution_2</span>
<span class="w">  </span><span class="nt">inception_3a</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_3a.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">maxpool_2</span>
<span class="w">  </span><span class="nt">inception_3b</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_3b.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_3a</span>
<span class="w">  </span><span class="nt">maxpool_3</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.MaxPool2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_3b</span>
<span class="w">  </span><span class="nt">inception_4a</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_4a.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">maxpool_3</span>
<span class="w">  </span><span class="nt">inception_4b</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_4b.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_4a</span>
<span class="w">  </span><span class="nt">inception_4c</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_4c.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_4b</span>
<span class="w">  </span><span class="nt">inception_4d</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_4d.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_4c</span>
<span class="w">  </span><span class="nt">inception_4e</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_4e.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_4d</span>
<span class="w">  </span><span class="nt">maxpool_4</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.MaxPool2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_4e</span>
<span class="w">  </span><span class="nt">inception_5a</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_5a.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">maxpool_4</span>
<span class="w">  </span><span class="nt">inception_5b</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_5b.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_5a</span>
<span class="w">  </span><span class="nt">avgpool</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.AdaptiveAvgPool2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">output_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_5b</span>
<span class="w">  </span><span class="nt">dropout</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.Dropout</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">p</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.4</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">avgpool</span>
<span class="w">  </span><span class="nt">flatten</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.Flatten</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">start_dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">end_dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dropout</span>
<span class="w">  </span><span class="nt">linear</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.Linear</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in_features</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1024</span>
<span class="w">      </span><span class="nt">out_features</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flatten</span>
<span class="w">  </span><span class="nt">softmax</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.Softmax</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">linear</span>
<span class="w">  </span><span class="nt">auxiliary_classifier_4a</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/auxiliary_classifier_4a.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_4a</span>
<span class="w">  </span><span class="nt">auxiliary_classifier_4b</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/auxiliary_classifier_4b.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_4d</span>
<span class="w">  </span><span class="nt">output</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">auxiliary_classifier_4a</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">auxiliary_classifier_4b</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">softmax</span>
</code></pre></div>
</details>
</li>
<li>
<p><strong><em>Download PNG</em></strong> and <strong><em>Download SVG</em></strong>: The user can download the rendered architecture as a PNG or SVG file. The SVG file is recommended for high-quality images, which can also be edited using Inkscape, Adobe Illustrator, or any other SVG editor.</p>
</li>
<li>
<p><strong><em>Show Edge Labels</em></strong>: The user can toggle the edge labels on and off. The edge labels show the names of output going into the next node, which can be useful when the architecture is complex. Default is off.</p>
<div class="admonition example">
<p class="admonition-title">Show edge labels</p>
<p>Showing edge labels can be useful for complex input structures. For example, in Graph Neural Networks (GNNs), the input can consist of the point positions (<code>pos</code>) and the edge indices (<code>edge_index</code>) of the graph, as well as the batch indices (<code>batch</code>). These inputs are passed to different modules in the GNN. An example is shown below, where the edge labels are shown. The YAML file for this graph is also attached below. This example is based on this <a href="https://colab.research.google.com/drive/1D45E5bUK3gQ40YpZo65ozs7hg5l-eo_U?usp=sharing"><strong>notebook</strong></a> from PyTorch Geometric tutorials.</p>
<figure>
<p><img alt="show_edge_labels" src="assets/point_net_conv.svg" width="100%"></p>
<figcaption>
<p>Graph Neural Network (GNN) example with edge labels.</p>
</figcaption>
</figure>
</div>
<details class="example">
<summary>YAML file for the GNN example</summary>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">point_net_conv</span>
<span class="nt">modules</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pos</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">edge_index</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">batch</span>

<span class="w">  </span><span class="nt">point_net_conv_1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pos</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pos</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">edge_index</span>

<span class="w">  </span><span class="nt">relu_1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">point_net_conv_1</span>

<span class="w">  </span><span class="nt">point_net_conv_2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">relu_1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pos</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">edge_index</span>

<span class="w">  </span><span class="nt">relu_2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">point_net_conv_2</span>

<span class="w">  </span><span class="nt">global_max_pool</span><span class="p">:</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">relu_2</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">batch</span>

<span class="w">  </span><span class="nt">classifier</span><span class="p">:</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global_max_pool</span>

<span class="w">  </span><span class="nt">output</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">classifier</span>
</code></pre></div>
</details>
</li>
<li>
<p><strong><em>Display of Module Configurations</em></strong>: The user can hover the mouse over the module to see the configuration parameters of the module if specified.</p>
<div class="admonition example">
<p class="admonition-title">Show module configuration</p>
<figure>
<p><img alt="hover" src="assets/hover.png" width="90%"></p>
<figcaption>
<p>Hovering over the module shows the configuration parameters of the module. </p>
</figcaption>
</figure>
</div>
</li>
</ul>
<h3 id="33-composablemodel">3.3 ComposableModel</h3>
<p>The <strong><em>ComposableModel</em></strong> (<strong><em>CM</em></strong>) is a special type of module that allows the user to interact with it. Specifically, when the user double-clicks the <strong><em>CM</em></strong>, the view expands into the module to show its internal structure. </p>
<p>Expanding into nested <strong><em>CM</em></strong>s allows the user to inspect the details of the block without cluttering the main architecture. The visualization tool keeps track of the level of the expanded <strong><em>CM</em></strong>. The <strong><em>Go Back</em></strong> button appears in the expanded view that allows the user to go back to the upper level architecture. The <strong><em>CM</em></strong>s can be nested to any level, so the user can choose the level of granularity that best suits their needs.</p>
<p>The video below shows an example of interacting with the <strong><em>CM</em></strong>s (inception blocks) in the GoogLeNet.</p>
<div class="admonition example">
<p class="admonition-title">Interacting with ComposableModel</p>
<p><div class="video-container"><iframe src="assets/expand_cm.mp4" style="position:relative;width:100%;height:22.172vw" frameborder="0" allowfullscreen alt="type:video"></iframe></div></p>
</div>
<h2 id="4-building-the-model">4. Building the model</h2>
<p>Currently, PyTorch is the only supported framework for building the model. See also the <a href="https://github.com/liuji1031/model_composer"><strong>repository</strong></a> for more details on how to build the model from the YAML file.</p>
<p>Here we will use the GoogLeNet example shown above to illustrate how to build the model. The YAML file is attached below, along with the rendered architecture.</p>
<details class="example">
<summary>model.yaml of GoogLeNet</summary>
<div class="highlight"><pre><span></span><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GoogLeNet</span>
<span class="nt">modules</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x</span>
<span class="w">  </span><span class="nt">convolution_1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Conv2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">out_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">64</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x</span>
<span class="w">  </span><span class="nt">maxpool_1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.MaxPool2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">convolution_1</span>
<span class="w">  </span><span class="nt">convolution_2_reduce</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Conv2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">64</span>
<span class="w">      </span><span class="nt">out_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">64</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">maxpool_1</span>
<span class="w">  </span><span class="nt">convolution_2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Conv2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">64</span>
<span class="w">      </span><span class="nt">out_channels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">convolution_2_reduce</span>
<span class="w">  </span><span class="nt">maxpool_2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.MaxPool2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">convolution_2</span>
<span class="w">  </span><span class="nt">inception_3a</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_3a.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">maxpool_2</span>
<span class="w">  </span><span class="nt">inception_3b</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_3b.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_3a</span>
<span class="w">  </span><span class="nt">maxpool_3</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.MaxPool2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_3b</span>
<span class="w">  </span><span class="nt">inception_4a</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_4a.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">maxpool_3</span>
<span class="w">  </span><span class="nt">inception_4b</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_4b.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_4a</span>
<span class="w">  </span><span class="nt">inception_4c</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_4c.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_4b</span>
<span class="w">  </span><span class="nt">inception_4d</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_4d.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_4c</span>
<span class="w">  </span><span class="nt">inception_4e</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_4e.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_4d</span>
<span class="w">  </span><span class="nt">maxpool_4</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.MaxPool2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">kernel_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">      </span><span class="nt">stride</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">      </span><span class="nt">padding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_4e</span>
<span class="w">  </span><span class="nt">inception_5a</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_5a.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">maxpool_4</span>
<span class="w">  </span><span class="nt">inception_5b</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/inception_5b.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_5a</span>
<span class="w">  </span><span class="nt">avgpool</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.AdaptiveAvgPool2d</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">output_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_5b</span>
<span class="w">  </span><span class="nt">dropout</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.Dropout</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">p</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.4</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">avgpool</span>
<span class="w">  </span><span class="nt">flatten</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.Flatten</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">start_dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">end_dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dropout</span>
<span class="w">  </span><span class="nt">linear</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.Linear</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">in_features</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1024</span>
<span class="w">      </span><span class="nt">out_features</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flatten</span>
<span class="w">  </span><span class="nt">softmax</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.nn.Softmax</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">linear</span>
<span class="w">  </span><span class="nt">auxiliary_classifier_4a</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/auxiliary_classifier_4a.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_4a</span>
<span class="w">  </span><span class="nt">auxiliary_classifier_4b</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ComposableModel</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config/auxiliary_classifier_4b.yaml</span>
<span class="w">    </span><span class="nt">inp_src</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inception_4d</span>
<span class="w">  </span><span class="nt">output</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">auxiliary_classifier_4a</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">auxiliary_classifier_4b</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">softmax</span>
</code></pre></div>
</details>
<div class="admonition example">
<p class="admonition-title">Rendered architecture of GoogLeNet</p>
<figure>
<p><img alt="googlenet" src="assets/googlenet.svg" width="100%"></p>
<figcaption>
<p>Architecture of the GoogLeNet. </p>
</figcaption>
</figure>
</div>
<h3 id="41-registering-modules">4.1 Registering modules</h3>
<ul>
<li>Currently all <code>torch.nn</code> modules are supported. These modules are automatically registered with the <code>ModuleRegistry</code> class, and can be directly used in the <strong><em>cls</em></strong> field in YAML file, e.g., <code>torch.nn.Conv2d</code>, <code>torch.nn.Linear</code>, etc.</li>
<li>
<p>The user can define their own modules through registering with the <code>ModuleReisgtry</code> class.</p>
<div class="admonition example">
<p class="admonition-title">Registering a custom module</p>
<p>In the GoogLeNet example above, the <strong><em>DepthConcat</em></strong> module is a custom module that concatenates the inputs along the specified dimension. The <strong><em>Conv2d</em></strong> module is a simple wrapper around <code>torch.nn.Conv2d</code> that adds batch normalization and ReLU activation. All other modules are native <code>torch.nn</code> modules. The code for defining and registering the custom modules is shown below.
</p><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">model_composer</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModuleRegistry</span>


<span class="nd">@ModuleRegistry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">"DepthConcat"</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DepthConcat</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Concatenate the inputs along the specified dimension."""</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>


<span class="nd">@ModuleRegistry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">"Conv2d"</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Conv2d</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""A simple wrapper around torch.nn.Conv2d."""</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_channels</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">padding</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2d</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span>
            <span class="n">in_channels</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">padding</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bn</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">(</span><span class="n">out_channels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relu</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2d</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
</code></pre></div>
</div>
</li>
<li>
<p>The user can choose to define custom modules at any level of granularity they see fit and compose them together to form a final <strong><em>ComposableModel</em></strong>. The GoogLeNet example above only used nested <strong><em>CM</em></strong>s to define the inception blocks and auxiliary classifiers, but the user is free to group other modules together to form a <strong><em>CM</em></strong>.</p>
</li>
</ul>
<h3 id="42-building-the-model">4.2 Building the model</h3>
<p>The model can be built by supplying the YAML config file to the <strong><em>ComposableModel</em></strong> class. The class will automatically parse the YAML file and build the model. It automatically determines the correct sequence to call the modules specified in the YAML file with the correct input sources. The code example for building the GoogLeNet model is shown below.</p>
<div class="admonition example">
<p class="admonition-title">Building the GoogLeNet model</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">model_composer</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_config</span><span class="p">,</span> <span class="n">ComposableModel</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="n">read_config</span><span class="p">(</span><span class="s2">"example/GoogLeNet/model.yaml"</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ComposableModel</span><span class="p">(</span><span class="o">**</span><span class="n">cfg</span><span class="p">)</span>
</code></pre></div>
</div>
<p>Verifying the model output shape is as expected (all three outputs should be of shape <code>[batch, 1000]</code> for the GoogLeNet model):</p>
<div class="admonition example">
<p class="admonition-title">Verifying the model output shape</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">loguru</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">print_output_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">out</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Output </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> shape: </span><span class="si">{</span><span class="n">out</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.522<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>convolution_1<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">64</span>,<span class="w"> </span><span class="m">112</span>,<span class="w"> </span><span class="m">112</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.529<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>maxpool_1<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">64</span>,<span class="w"> </span><span class="m">56</span>,<span class="w"> </span><span class="m">56</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.533<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>convolution_2_reduce<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">64</span>,<span class="w"> </span><span class="m">56</span>,<span class="w"> </span><span class="m">56</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.540<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>convolution_2<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">192</span>,<span class="w"> </span><span class="m">56</span>,<span class="w"> </span><span class="m">56</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.545<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>maxpool_2<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">192</span>,<span class="w"> </span><span class="m">28</span>,<span class="w"> </span><span class="m">28</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.556<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>inception_3a<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">256</span>,<span class="w"> </span><span class="m">28</span>,<span class="w"> </span><span class="m">28</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.572<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>inception_3b<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">480</span>,<span class="w"> </span><span class="m">28</span>,<span class="w"> </span><span class="m">28</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.576<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>maxpool_3<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">480</span>,<span class="w"> </span><span class="m">14</span>,<span class="w"> </span><span class="m">14</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.586<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>inception_4a<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">512</span>,<span class="w"> </span><span class="m">14</span>,<span class="w"> </span><span class="m">14</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.596<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>inception_4b<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">512</span>,<span class="w"> </span><span class="m">14</span>,<span class="w"> </span><span class="m">14</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.600<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>auxiliary_classifier_4a<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">1000</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.609<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>inception_4c<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">512</span>,<span class="w"> </span><span class="m">14</span>,<span class="w"> </span><span class="m">14</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.619<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>inception_4d<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">528</span>,<span class="w"> </span><span class="m">14</span>,<span class="w"> </span><span class="m">14</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.630<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>inception_4e<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">832</span>,<span class="w"> </span><span class="m">14</span>,<span class="w"> </span><span class="m">14</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.634<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>auxiliary_classifier_4b<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">1000</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.636<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>maxpool_4<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">832</span>,<span class="w"> </span><span class="m">7</span>,<span class="w"> </span><span class="m">7</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.643<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>inception_5a<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">832</span>,<span class="w"> </span><span class="m">7</span>,<span class="w"> </span><span class="m">7</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.651<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>inception_5b<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">1024</span>,<span class="w"> </span><span class="m">7</span>,<span class="w"> </span><span class="m">7</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.653<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>avgpool<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">1024</span>,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="m">1</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.654<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>dropout<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">1024</span>,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="m">1</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.656<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>flatten<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">1024</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.658<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>linear<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">1000</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.659<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>model_composer.composer:forward:228<span class="w"> </span>-<span class="w"> </span>Module<span class="w"> </span>softmax<span class="w"> </span>output<span class="w"> </span>shape:<span class="w"> </span><span class="o">[</span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">1000</span><span class="o">])]</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.665<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>__main__:&lt;module&gt;:7<span class="w"> </span>-<span class="w"> </span>Output<span class="w"> </span><span class="m">0</span><span class="w"> </span>shape:<span class="w"> </span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">1000</span><span class="o">])</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.666<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>__main__:&lt;module&gt;:7<span class="w"> </span>-<span class="w"> </span>Output<span class="w"> </span><span class="m">1</span><span class="w"> </span>shape:<span class="w"> </span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">1000</span><span class="o">])</span>
<span class="m">2025</span>-05-08<span class="w"> </span><span class="m">12</span>:33:28.667<span class="w"> </span><span class="p">|</span><span class="w"> </span>INFO<span class="w">     </span><span class="p">|</span><span class="w"> </span>__main__:&lt;module&gt;:7<span class="w"> </span>-<span class="w"> </span>Output<span class="w"> </span><span class="m">2</span><span class="w"> </span>shape:<span class="w"> </span>torch.Size<span class="o">([</span><span class="m">1</span>,<span class="w"> </span><span class="m">1000</span><span class="o">])</span>
</code></pre></div>
</div>
<h2 id="5-summary">5. Summary</h2>
<p>In this tutorial, we introduced the <strong><em>ComposableModel</em></strong> (<strong><em>CM</em></strong>) format for defining neural network architectures in a YAML file. The format is designed to be flexible and extensible, allowing the user to define complex architectures with ease. The visualization tool provides an intuitive interface for exploring the architecture and inspecting the details of the model. The model can be built using PyTorch, and custom modules can be registered for use in the YAML file.</p>
<p>Next, we will dive a bit deeper into <a href="rationale/"><strong>why I think using the format might actually be useful</strong></a>.</p></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
        
          
          <a href="rationale/" class="md-footer__link md-footer__link--next" aria-label="Next: Why this could be useful">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Why this could be useful
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["navigation.footer"], "search": "assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>